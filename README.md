# QAUTLRA-RS

QAUTLRA-RSæ˜¯ä¸€ä¸ªåŸºäºRustå®ç°çš„é«˜æ€§èƒ½é‡åŒ–äº¤æ˜“å’Œå¸‚åœºæ•°æ®å¤„ç†å¹³å°ï¼Œä¸ºé‡‘èå¸‚åœºåˆ†æå’Œäº¤æ˜“æä¾›å®Œæ•´çš„æŠ€æœ¯åŸºç¡€è®¾æ–½ã€‚

![QAUTLRA-RS](qars/QUANTAXISRS.png)

## ğŸš€ é¡¹ç›®æ¦‚è¿°

QAUTLRA-RSé¡¹ç›®æ—¨åœ¨æ„å»ºä¸€ä¸ªå®Œæ•´çš„é‡åŒ–äº¤æ˜“æŠ€æœ¯æ ˆï¼Œå……åˆ†åˆ©ç”¨Rustè¯­è¨€çš„é«˜æ€§èƒ½ã€å†…å­˜å®‰å…¨å’Œå¹¶å‘ç‰¹æ€§ï¼Œä¸ºé‡åŒ–äº¤æ˜“æä¾›å¯é çš„æŠ€æœ¯æ”¯æŒã€‚å¹³å°ç”±å¤šä¸ªç‹¬ç«‹ä½†ååŒå·¥ä½œçš„å­ç³»ç»Ÿç»„æˆï¼Œæ”¯æŒä»å¸‚åœºæ•°æ®æ¥å…¥ã€è¡Œæƒ…åˆ†å‘ã€ç­–ç•¥æ‰§è¡Œåˆ°äº¤æ˜“æ‰§è¡Œçš„å®Œæ•´é‡åŒ–äº¤æ˜“æµç¨‹ã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

- **é«˜æ€§èƒ½æ¶æ„**ï¼šåŸºäºRustè¯­è¨€å¼€å‘ï¼Œå®ç°æ¯«ç§’çº§ä½å»¶è¿Ÿæ•°æ®å¤„ç†
- **å¤šæºæ•°æ®æ¥å…¥**ï¼šæ”¯æŒCTPã€æ–°æµªè´¢ç»ã€è…¾è®¯è´¢ç»ç­‰å¤šç§å¸‚åœºæ•°æ®æº
- **å®æ—¶è¡Œæƒ…åˆ†å‘**ï¼šåŸºäºWebSocketçš„é«˜æ•ˆè¡Œæƒ…æ•°æ®æ¨é€
- **å¢é‡æ•°æ®æ›´æ–°**ï¼šé¦–æ¬¡è¿æ¥å‘é€å…¨é‡æ•°æ®ï¼Œä¹‹åä»…æ¨é€å˜åŒ–çš„å­—æ®µï¼Œå¤§å¹…å‡å°‘å¸¦å®½æ¶ˆè€—
- **ç»Ÿä¸€æ•°æ®æ ¼å¼**ï¼šæ ‡å‡†åŒ–ä¸åŒæ¥æºçš„å¸‚åœºæ•°æ®ï¼Œæä¾›ä¸€è‡´çš„æ•°æ®æ¥å£
- **åˆ†å¸ƒå¼è®¾è®¡**ï¼šåŸºäºActoræ¨¡å‹çš„åˆ†å¸ƒå¼å¹¶å‘å¤„ç†æ¶æ„
- **å®‰å…¨å¯é **ï¼šå……åˆ†åˆ©ç”¨Rustçš„å†…å­˜å®‰å…¨ç‰¹æ€§ï¼Œæä¾›ç¨³å®šå¯é çš„è¿è¡Œç¯å¢ƒ
- **æ¨¡å—åŒ–ç»„ä»¶**ï¼šå„å­ç³»ç»Ÿå¯ç‹¬ç«‹è¿è¡Œï¼Œä¹Ÿå¯ååŒå·¥ä½œ

## ğŸ“š ç³»ç»Ÿç»„æˆ

QAUTLRA-RSç”±ä»¥ä¸‹ä¸»è¦ç»„ä»¶æ„æˆï¼š

### 1. QAMDGATEWAY - å¸‚åœºæ•°æ®ç½‘å…³

```
å†™åœ¨å‰é¢ï¼š

é¦–å…ˆè‡´è°¢ç½—æ€»çš„openctpæä¾›çš„æ ‡å‡†çš„è¡Œæƒ…æ¥å…¥ æ›´å¤šopenctpçš„ç›¸å…³å¯ä»¥å‚è€ƒ

openctp å®˜ç½‘ [http://www.openctp.cn/]

openctp çš„github  [https://github.com/openctp/openctp]

@yutiansut 

```

å¸‚åœºæ•°æ®ç½‘å…³æ˜¯æ•´ä¸ªç³»ç»Ÿçš„æ•°æ®å…¥å£ï¼Œè´Ÿè´£è¿æ¥å„ç±»å¸‚åœºæ•°æ®æºï¼Œå¹¶å°†æ•°æ®è½¬æ¢ä¸ºç»Ÿä¸€æ ¼å¼ååˆ†å‘ç»™è®¢é˜…è€…ã€‚

**ä¸»è¦åŠŸèƒ½**:
- è¿æ¥å’Œç®¡ç†å¤šä¸ªå¸‚åœºæ•°æ®æº
- å°†åŸå§‹å¸‚åœºæ•°æ®è½¬æ¢ä¸ºæ ‡å‡†QAMDæ•°æ®ç»“æ„
- é€šè¿‡WebSocketå®æ—¶æ¨é€è¡Œæƒ…æ•°æ®
- æä¾›REST APIç”¨äºè®¢é˜…ç®¡ç†
- æ”¯æŒå¢é‡æ•°æ®æ›´æ–°ï¼Œå¤§å¹…æå‡æ€§èƒ½å’Œå‡å°‘ç½‘ç»œæµé‡

**å­ç»„ä»¶**:
- **qamdgateway-ctp**: è¿æ¥CTPäº¤æ˜“ç³»ç»Ÿçš„å¸‚åœºæ•°æ®ç½‘å…³
- **qamdgateway-qq**: è¿æ¥è…¾è®¯è´¢ç»çš„å¸‚åœºæ•°æ®ç½‘å…³
- **qamdgateway-sina**: è¿æ¥æ–°æµªè´¢ç»çš„å¸‚åœºæ•°æ®ç½‘å…³

### 2. QAMD-RS - å¸‚åœºæ•°æ®å¤„ç†åº“

å¸‚åœºæ•°æ®å¤„ç†åº“æä¾›äº†æ ‡å‡†åŒ–çš„æ•°æ®ç»“æ„å’Œå¤„ç†å·¥å…·ï¼Œç”¨äºå¤„ç†å’Œè½¬æ¢å„ç±»å¸‚åœºæ•°æ®ã€‚

**ä¸»è¦åŠŸèƒ½**:
- å®šä¹‰æ ‡å‡†åŒ–çš„å¸‚åœºæ•°æ®ç»“æ„
- æä¾›æ•°æ®è½¬æ¢å’Œå¤„ç†å·¥å…·
- æ”¯æŒä¸åŒæ¥æºæ•°æ®çš„æ ¼å¼è½¬æ¢

### 3. QARS - é‡åŒ–äº¤æ˜“å¼•æ“æ ¸å¿ƒåº“

QARSæ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒè®¡ç®—å¼•æ“ï¼Œæä¾›é‡åŒ–åˆ†æå’Œäº¤æ˜“ç­–ç•¥æ‰§è¡Œçš„åŠŸèƒ½ã€‚

**ä¸»è¦åŠŸèƒ½**:
- é«˜æ€§èƒ½å›æµ‹å¼•æ“
- å› å­è®¡ç®—å’Œåˆ†æå·¥å…·
- ç­–ç•¥æ‰§è¡Œå¼•æ“
- æ”¯æŒä¸Pythonäº¤äº’çš„æ¥å£

### 4. QIFI-RS - é‡‘èäº¤æ˜“æ¥å£æ ‡å‡†

QIFI-RSæ˜¯Quantaxis Financial Interfaceçš„Rustå®ç°ï¼Œæä¾›æ ‡å‡†åŒ–çš„é‡‘èäº¤æ˜“æ¥å£åè®®ã€‚

**ä¸»è¦åŠŸèƒ½**:
- å®šä¹‰æ ‡å‡†è´¦æˆ·æ•°æ®ç»“æ„
- æä¾›å¿«é€Ÿçš„æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–
- æ”¯æŒä»JSON/BSONæ ¼å¼åŠ è½½å’Œè½¬æ¢æ•°æ®
- å…¼å®¹MongoDBæ•°æ®åº“æ“ä½œ

### 5. CTP-MD - CTPå¸‚åœºæ•°æ®æ¥å£

CTPå¸‚åœºæ•°æ®æ¥å£æä¾›äº†è¿æ¥ä¸­å›½é‡‘èæœŸè´§äº¤æ˜“æ‰€CTPç³»ç»Ÿçš„Rustç»‘å®šã€‚

**ä¸»è¦åŠŸèƒ½**:
- æä¾›CTP APIçš„Rustå°è£…
- å®ç°CTPå¸‚åœºæ•°æ®çš„æ¥æ”¶å’Œå¤„ç†
- æ”¯æŒå¤šç§æœŸè´§åˆçº¦çš„è®¢é˜…

### 6. QAOMS - é‡åŒ–äº¤æ˜“å‰ç«¯ç³»ç»Ÿ

é‡åŒ–äº¤æ˜“å‰ç«¯ç³»ç»Ÿæä¾›äº†ç”¨æˆ·äº¤äº’ç•Œé¢ï¼ŒåŒ…æ‹¬è¡Œæƒ…æ˜¾ç¤ºã€äº¤æ˜“æ“ä½œå’Œç­–ç•¥ç®¡ç†ç­‰åŠŸèƒ½ã€‚

**ä¸»è¦åŠŸèƒ½**:
- è¡Œæƒ…æ•°æ®å¯è§†åŒ–
- äº¤æ˜“æ“ä½œç•Œé¢
- ç­–ç•¥ç®¡ç†å’Œç›‘æ§
- è´¦æˆ·å’ŒæŒä»“å±•ç¤º

## ğŸ”§ ç³»ç»Ÿæ¶æ„

```
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚                   â”‚
                                  â”‚  Market Data      â”‚
                                  â”‚  Distributor      â”‚
                                  â”‚  (Actor)          â”‚
                                  â”‚                   â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–²      â”‚
                                    â”‚      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚  â”‚                   â”‚  â”‚                  â”‚
â”‚ CTP Market Data â”‚â”€â–¶â”‚ Market Data       â”‚â—€â”€â”‚ WebSocket        â”‚
â”‚ Source (Actor)  â”‚  â”‚ Connector         â”‚  â”‚ Clients          â”‚
â”‚                 â”‚  â”‚ (Actor)           â”‚  â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–²     â–²
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚     â”‚     â”‚     â”‚                  â”‚
â”‚ QQ Market Data  â”‚â”€â”€â”€â”€â–¶â”‚     â”‚â—€â”€â”€â”€â”€â”‚ REST API         â”‚
â”‚ Source (Actor)  â”‚           â”‚     â”‚ Clients          â”‚
â”‚                 â”‚           â”‚     â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚                 â”‚           â”‚
â”‚ Sina Market Dataâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
â”‚ Source (Actor)  â”‚
â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ å®‰è£…æŒ‡å—

### ç¯å¢ƒè¦æ±‚

- Rust (æ¨èç‰ˆæœ¬: 1.70+)
- Cargo
- CMake (ç”¨äºç¼–è¯‘CTPç›¸å…³ä¾èµ–)
- GCC/Clang (C++ç¼–è¯‘å™¨)
- Node.js (ç”¨äºå‰ç«¯ç³»ç»Ÿ)

### ä»æºç æ„å»º

1. å…‹éš†ä»“åº“ï¼š

```bash
git clone https://github.com/yutiansut/qautlra-rs.git
cd qautlra-rs
```

2. æ„å»ºå¸‚åœºæ•°æ®ç½‘å…³ï¼š

```bash
# æ„å»ºæ”¯æŒCTPçš„å¸‚åœºæ•°æ®ç½‘å…³
QAMDGATEWAY_CONFIG_PATH=config_ctp.json cargo run -p qamdgateway --no-default-features --features="ctp"

# æ„å»ºæ”¯æŒQQè´¢ç»çš„å¸‚åœºæ•°æ®ç½‘å…³
QAMDGATEWAY_CONFIG_PATH=config_qq.json cargo run -p qamdgateway --no-default-features --features="qq"

# æ„å»ºæ”¯æŒæ–°æµªè´¢ç»çš„å¸‚åœºæ•°æ®ç½‘å…³
QAMDGATEWAY_CONFIG_PATH=config_sina.json cargo run -p qamdgateway --no-default-features --features="sina"
```

3. æ„å»ºå‰ç«¯ç³»ç»Ÿï¼š

```bash
cd qaoms/web
npm install
npm run dev
```

## âš™ï¸ é…ç½®

é…ç½®æ–‡ä»¶ä½äºé¡¹ç›®æ ¹ç›®å½•çš„`config.json`åŠå…¶å˜ä½“æ–‡ä»¶ä¸­ï¼ŒåŒ…å«ä»¥ä¸‹ä¸»è¦é…ç½®ï¼š

### CTPå¸‚åœºæ•°æ®ç½‘å…³é…ç½®ç¤ºä¾‹

```json
{
  "brokers": {
    "simnow724": {
      "name": "simnow724",
      "front_addr": "tcp://180.168.146.187:10131",
      "user_id": "YOUR_USER_ID",
      "password": "YOUR_PASSWORD",
      "broker_id": "9999"
    }
  },
  "default_broker": "simnow724",
  "websocket": {
    "host": "0.0.0.0",
    "port": 8014,
    "path": "/ws/market"
  },
  "rest_api": {
    "host": "0.0.0.0",
    "port": 8015
  },
  "incremental_updates": {
    "enabled": true,
    "batch_interval_ms": 100,
    "batch_size_threshold": 50
  }
}
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### è®¢é˜…å¸‚åœºæ•°æ®

å¹³å°æä¾›äº†ä¸‰ç§WebSocketè¿æ¥ç«¯ç‚¹ï¼š

1. CTPè¡Œæƒ…ï¼š`ws://localhost:8014/ws/market`
2. QQè¡Œæƒ…ï¼š`ws://localhost:8016/ws/market`
3. æ–°æµªè¡Œæƒ…ï¼š`ws://localhost:8012/ws/market`

#### WebSocketè®¢é˜…ç¤ºä¾‹

```javascript
// åˆ›å»ºWebSocketè¿æ¥
const ws = new WebSocket("ws://localhost:8014/ws/market");

// è®¢é˜…åˆçº¦
ws.onopen = function() {
  const subscribeMsg = {
    "aid": "subscribe_quote",
    "ins_list": "au2512,rb2512,IF2506"
  };
  ws.send(JSON.stringify(subscribeMsg));
};

// æ¥æ”¶è¡Œæƒ…æ•°æ®
ws.onmessage = function(evt) {
  const data = JSON.parse(evt.data);
  console.log("æ¥æ”¶åˆ°è¡Œæƒ…æ•°æ®:", data);
};
```

#### å¤„ç†å¢é‡æ•°æ®æ›´æ–°

```javascript
// å®¢æˆ·ç«¯ç»´æŠ¤å®Œæ•´çš„è¡Œæƒ…å¿«ç…§
const marketDataSnapshots = {};

ws.onmessage = function(evt) {
  const message = JSON.parse(evt.data);
  
  // å¤„ç†TradingViewæ ¼å¼çš„æ•°æ®
  if (message.aid === "rtn_data" && message.data && message.data.length > 0) {
    const quotes = message.data[0].quotes;
    
    // æ›´æ–°æœ¬åœ°å¿«ç…§
    for (const [symbol, quoteData] of Object.entries(quotes)) {
      // å¦‚æœæ˜¯æ–°åˆçº¦ï¼Œåˆ›å»ºæ–°å¿«ç…§
      if (!marketDataSnapshots[symbol]) {
        marketDataSnapshots[symbol] = {};
      }
      
      // æ›´æ–°å¿«ç…§ä¸­å˜åŒ–çš„å­—æ®µ
      for (const [field, value] of Object.entries(quoteData)) {
        marketDataSnapshots[symbol][field] = value;
      }
      
      // ä½¿ç”¨æ›´æ–°åçš„å®Œæ•´å¿«ç…§
      console.log(`æ›´æ–°åçš„${symbol}å¿«ç…§:`, marketDataSnapshots[symbol]);
    }
  }
};
```

### REST APIä½¿ç”¨ç¤ºä¾‹

```bash
# è·å–å½“å‰è®¢é˜…ä¿¡æ¯
curl http://localhost:8015/api/subscriptions

# è®¢é˜…æ–°åˆçº¦
curl -X POST http://localhost:8015/api/subscribe \
  -H "Content-Type: application/json" \
  -d '{"instruments": ["au2512", "rb2512"]}'

# å–æ¶ˆè®¢é˜…
curl -X POST http://localhost:8015/api/unsubscribe \
  -H "Content-Type: application/json" \
  -d '{"instruments": ["au2512"]}'
```

## ğŸ“Š æ•°æ®ç»“æ„

### æ ‡å‡†å¸‚åœºæ•°æ®æ ¼å¼

```json
{
  "type": "market_data",
  "payload": {
    "data": {
      "instrument_id": "SHFE.au2512",
      "exchange_id": "SHFE",
      "instrument_name": "é»„é‡‘2512",
      "datetime": "2023-05-20T10:30:00.000Z",
      "last_price": 2056.5,
      "open": 2050.0,
      "high": 2060.0,
      "low": 2048.5,
      "volume": 12500,
      "open_interest": 25678,
      "bid_price1": 2056.0,
      "bid_volume1": 56,
      "ask_price1": 2057.0,
      "ask_volume1": 78,
      "source": "CTP"
    }
  }
}
```

### QIFIè´¦æˆ·æ•°æ®ç»“æ„

QIFI-RSæä¾›äº†æ ‡å‡†åŒ–çš„è´¦æˆ·æ•°æ®ç»“æ„ï¼ŒåŒ…æ‹¬è´¦æˆ·èµ„é‡‘ã€æŒä»“ã€è®¢å•å’Œäº¤æ˜“è®°å½•ç­‰ä¿¡æ¯ã€‚

## ğŸ§© ç»„ä»¶è¯¦æƒ…

### QAMDGATEWAY

å¸‚åœºæ•°æ®ç½‘å…³åŸºäºActixæ¡†æ¶å®ç°Actoræ¨¡å‹ï¼Œä¸»è¦ç»„ä»¶åŒ…æ‹¬ï¼š

- **MarketDataConnector**ï¼šè´Ÿè´£è¿æ¥å’Œç®¡ç†å¤šä¸ªå¸‚åœºæ•°æ®æº
- **MarketDataDistributor**ï¼šè´Ÿè´£å°†å¸‚åœºæ•°æ®åˆ†å‘ç»™è®¢é˜…çš„å®¢æˆ·ç«¯
- **MarketDataActor**ï¼šå¤„ç†å„ç±»è¡Œæƒ…æºçš„Actorå®ç°
- **WebSocket Server**ï¼šé€šè¿‡WebSocketåè®®å¯¹å¤–æä¾›è¡Œæƒ…æ•°æ®

### QARS

é‡åŒ–äº¤æ˜“å¼•æ“æ ¸å¿ƒåº“æä¾›äº†å¤šç§é‡åŒ–åˆ†æå’Œäº¤æ˜“åŠŸèƒ½ï¼š

- æ ‡å‡†è´¦æˆ·åè®®ï¼ˆè‚¡ç¥¨/æœŸè´§ï¼‰
- æŠ•èµ„ç»„åˆåè®®ï¼ˆå¤šè´¦æˆ·ç®¡ç†ï¼‰
- æ ‡å‡†å¸‚åœºæ•°æ®æ¥å£
- æ ‡å‡†è¿æ¥åè®®ï¼ˆMongoDBã€ClickHouseã€RabbitMQï¼‰
- æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæ¥å£

### QAOMS

å‰ç«¯ç³»ç»ŸåŸºäºVue.jså¼€å‘ï¼Œæä¾›äº†å‹å¥½çš„ç”¨æˆ·ç•Œé¢ï¼š

- è¡Œæƒ…æ•°æ®å±•ç¤º
- Kçº¿å›¾è¡¨
- äº¤æ˜“æ“ä½œç•Œé¢
- è´¦æˆ·ç®¡ç†

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç æˆ–æå‡ºå»ºè®®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»ºPull Request

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ã€‚è¯¦æƒ…è¯·å‚è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºæœ¬é¡¹ç›®åšå‡ºè´¡çŒ®çš„ç¤¾åŒºæˆå‘˜ã€‚